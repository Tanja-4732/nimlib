use nimlib::{nimbers, NimRule, Nimber, Split, Stack, TakeSize};

/// Test the first 2000 nimbers of a game where the rules are:
/// Take 1, 3, 6, or 9; must split on 6, may split on 9; never place coins.
#[test]
fn extended_nimber_test() {
    let fancy_rules = vec![
        NimRule {
            take: TakeSize::List(vec![1, 3]),
            split: Split::Never,
        },
        NimRule {
            take: TakeSize::List(vec![6]),
            split: Split::Always,
        },
        NimRule {
            take: TakeSize::List(vec![9]),
            split: Split::Optional,
        },
    ];

    for (h, nimber) in TEST_NIMBERS.iter().enumerate() {
        assert_eq!(
            Stack(h as u64).calculate_nimber(&fancy_rules, 0),
            Nimber(*nimber as u64),
            "Nimber for height {h} is wrong"
        );
    }
}

// TODO double-check these numbers

/// These are the first 2000 nimbers of a game where the rules are:
/// Take 1, 3, 6, or 9; must split on 6, may split on 9; never place coins.
pub const TEST_NIMBERS: [u8; 2000] = [
    0, 1, 0, 1, 0, 1, 0, 1, 2, 3, 2, 3, 2, 3, 2, 4, 5, 4, 5, 4, 5, 1, 6, 7, 6, 7, 6, 7, 2, 3, 2, 3,
    2, 3, 2, 1, 5, 4, 5, 8, 9, 8, 9, 8, 6, 7, 6, 7, 6, 10, 11, 10, 5, 4, 5, 4, 12, 8, 9, 8, 9, 8,
    2, 3, 2, 3, 2, 10, 11, 10, 11, 13, 4, 5, 4, 5, 4, 5, 8, 6, 2, 3, 2, 7, 6, 10, 11, 16, 12, 13,
    10, 11, 12, 1, 12, 17, 18, 19, 18, 7, 6, 7, 6, 7, 15, 11, 20, 21, 5, 4, 5, 12, 13, 22, 23, 24,
    18, 19, 6, 7, 2, 14, 15, 14, 15, 17, 16, 5, 4, 5, 13, 12, 22, 23, 13, 20, 6, 7, 6, 7, 15, 14,
    16, 17, 28, 24, 8, 5, 3, 2, 13, 12, 18, 19, 10, 7, 6, 7, 10, 20, 21, 20, 28, 24, 8, 5, 4, 22,
    12, 13, 2, 18, 19, 11, 3, 10, 6, 16, 17, 1, 24, 25, 8, 9, 8, 9, 8, 4, 22, 23, 11, 3, 10, 2, 11,
    20, 21, 17, 1, 24, 1, 9, 8, 19, 18, 19, 27, 32, 3, 30, 11, 2, 11, 10, 21, 28, 21, 20, 24, 13,
    24, 8, 9, 8, 18, 27, 31, 26, 3, 2, 11, 32, 33, 29, 16, 25, 17, 8, 1, 8, 34, 35, 34, 30, 31, 30,
    11, 20, 21, 32, 21, 5, 21, 28, 24, 25, 9, 8, 34, 35, 34, 18, 19, 30, 31, 36, 32, 33, 2, 10, 20,
    32, 28, 12, 33, 4, 34, 35, 22, 6, 7, 15, 31, 10, 11, 37, 2, 21, 20, 16, 12, 13, 9, 38, 39, 1,
    26, 23, 22, 23, 14, 26, 32, 33, 15, 21, 20, 21, 13, 12, 13, 38, 43, 39, 42, 18, 19, 43, 1, 26,
    32, 33, 32, 44, 36, 35, 21, 20, 21, 4, 34, 35, 30, 18, 30, 42, 31, 33, 32, 15, 36, 29, 28, 16,
    17, 39, 38, 39, 35, 11, 35, 26, 31, 19, 32, 33, 32, 6, 32, 41, 28, 24, 29, 51, 4, 51, 47, 43,
    42, 22, 18, 19, 18, 37, 2, 32, 45, 44, 24, 8, 9, 45, 50, 46, 42, 52, 26, 49, 27, 22, 11, 37,
    36, 37, 36, 37, 40, 7, 24, 50, 21, 50, 42, 1, 52, 47, 26, 11, 18, 27, 56, 41, 40, 41, 29, 24,
    21, 20, 14, 20, 42, 38, 30, 31, 39, 52, 19, 10, 11, 45, 32, 3, 28, 16, 17, 16, 17, 34, 35, 34,
    4, 34, 6, 18, 49, 31, 60, 32, 13, 12, 45, 55, 28, 29, 17, 15, 46, 47, 34, 31, 19, 18, 19, 18,
    19, 32, 45, 21, 20, 21, 17, 21, 4, 58, 62, 42, 15, 31, 14, 26, 19, 18, 19, 40, 41, 40, 20, 16,
    20, 17, 39, 58, 59, 58, 42, 47, 26, 6, 7, 30, 49, 48, 60, 45, 55, 20, 21, 20, 5, 54, 58, 43,
    10, 62, 26, 15, 19, 8, 9, 8, 56, 41, 13, 64, 21, 20, 51, 46, 47, 43, 42, 11, 31, 22, 23, 60,
    23, 9, 36, 56, 29, 17, 16, 17, 55, 58, 3, 46, 43, 64, 18, 64, 18, 64, 57, 22, 57, 33, 32, 9,
    17, 20, 28, 21, 47, 46, 47, 43, 10, 18, 19, 31, 57, 56, 48, 41, 40, 64, 17, 50, 17, 24, 42, 43,
    62, 47, 68, 18, 68, 23, 56, 60, 31, 37, 64, 70, 55, 29, 62, 17, 43, 42, 43, 66, 27, 18, 19, 23,
    27, 56, 60, 49, 73, 20, 70, 8, 59, 54, 47, 54, 15, 68, 75, 74, 19, 18, 52, 56, 13, 40, 72, 73,
    16, 17, 37, 7, 24, 15, 35, 65, 34, 74, 68, 30, 45, 53, 13, 44, 73, 68, 69, 58, 70, 16, 55, 50,
    54, 64, 65, 19, 18, 19, 57, 41, 33, 4, 80, 72, 33, 21, 73, 50, 54, 59, 47, 73, 75, 14, 30, 31,
    19, 40, 18, 41, 12, 76, 64, 83, 78, 17, 64, 50, 35, 7, 35, 80, 30, 81, 22, 48, 22, 56, 85, 21,
    68, 28, 68, 21, 17, 16, 51, 55, 79, 78, 79, 80, 18, 52, 48, 49, 80, 49, 77, 29, 46, 21, 11, 50,
    54, 38, 71, 79, 23, 84, 23, 9, 48, 8, 77, 76, 90, 81, 93, 55, 3, 43, 64, 35, 64, 83, 79, 57,
    22, 53, 48, 49, 56, 68, 69, 68, 69, 55, 20, 21, 2, 97, 55, 97, 85, 70, 96, 65, 60, 52, 64, 72,
    73, 98, 80, 51, 50, 34, 100, 90, 21, 97, 85, 71, 85, 37, 49, 53, 52, 88, 98, 64, 98, 42, 38,
    51, 10, 62, 59, 80, 101, 92, 49, 48, 5, 48, 5, 103, 102, 85, 86, 106, 21, 51, 6, 29, 54, 97,
    37, 93, 49, 48, 19, 80, 53, 64, 98, 65, 95, 65, 34, 7, 51, 43, 95, 100, 105, 71, 48, 49, 48,
    12, 53, 98, 31, 98, 99, 64, 39, 16, 54, 51, 94, 100, 82, 74, 83, 102, 48, 49, 103, 26, 103, 99,
    98, 99, 106, 34, 72, 58, 100, 79, 96, 101, 71, 75, 48, 44, 49, 102, 103, 65, 80, 34, 25, 38,
    50, 51, 62, 101, 104, 44, 104, 32, 52, 57, 18, 68, 85, 110, 84, 110, 50, 106, 42, 51, 79, 67,
    101, 37, 40, 37, 36, 49, 64, 49, 84, 103, 65, 110, 54, 55, 6, 112, 17, 70, 71, 45, 104, 31, 36,
    93, 115, 92, 12, 110, 42, 39, 38, 54, 62, 82, 50, 95, 24, 32, 33, 108, 70, 80, 23, 69, 115, 68,
    84, 39, 46, 47, 112, 6, 63, 101, 109, 71, 67, 44, 48, 60, 64, 81, 57, 93, 35, 42, 122, 116, 51,
    29, 63, 120, 21, 37, 70, 36, 128, 52, 53, 115, 22, 106, 122, 38, 12, 117, 8, 66, 63, 66, 105,
    32, 41, 32, 40, 48, 49, 23, 84, 22, 39, 111, 38, 103, 124, 103, 105, 20, 29, 41, 37, 41, 32,
    53, 72, 119, 19, 119, 34, 42, 38, 113, 82, 125, 43, 21, 91, 87, 37, 40, 2, 88, 93, 41, 19, 127,
    30, 34, 47, 42, 58, 17, 83, 59, 82, 32, 33, 32, 93, 32, 93, 127, 80, 23, 30, 88, 12, 13, 46,
    42, 16, 87, 125, 103, 33, 45, 33, 53, 75, 18, 93, 18, 38, 47, 34, 35, 34, 98, 116, 98, 78, 104,
    109, 28, 41, 45, 44, 68, 127, 13, 38, 19, 31, 39, 38, 4, 120, 116, 117, 125, 17, 45, 60, 122,
    123, 68, 89, 126, 77, 128, 42, 39, 87, 86, 120, 86, 25, 16, 40, 29, 36, 6, 122, 92, 77, 13,
    119, 27, 26, 12, 43, 47, 108, 125, 25, 21, 25, 33, 37, 40, 128, 97, 89, 68, 69, 19, 27, 5, 13,
    5, 95, 94, 121, 130, 16, 33, 32, 44, 6, 80, 110, 81, 89, 18, 128, 27, 5, 130, 13, 112, 67, 86,
    70, 29, 25, 14, 44, 132, 93, 18, 19, 42, 30, 42, 35, 13, 130, 82, 125, 66, 40, 41, 3, 36, 7,
    41, 88, 128, 115, 31, 18, 26, 42, 38, 12, 116, 130, 21, 134, 24, 28, 2, 32, 33, 100, 22, 23,
    65, 30, 34, 35, 131, 4, 117, 116, 117, 131, 29, 28, 6, 2, 6, 128, 31, 80, 132, 47, 34, 1, 34,
    131, 77, 116, 130, 117, 45, 41, 32, 7, 137, 114, 126, 30, 27, 46, 38, 34, 42, 131, 130, 5, 113,
    131, 37, 36, 7, 2, 44, 129, 88, 81, 58, 46, 34, 35, 145, 8, 86, 95, 86, 91, 16, 36, 37, 3, 85,
    89, 84, 14, 92, 93, 38, 39, 131, 46, 131, 95, 113, 9, 100, 32, 33, 32, 11, 114, 27, 26, 99,
    132, 38, 137, 5, 12, 43, 113, 56, 57, 78, 44, 2, 37, 3, 129, 11, 80, 136, 128, 35, 34, 46, 39,
    100, 8, 96, 131, 130, 133, 37, 44, 15, 14, 129, 84, 89, 84, 129, 58, 47, 46, 9, 100, 9, 60, 82,
    32, 41, 40, 44, 103, 102, 81, 92, 122, 136, 43, 4, 46, 1, 134, 138, 53, 86, 131, 44, 37, 132,
    133, 81, 102, 123, 136, 47, 136, 135, 134, 135, 13, 8, 90, 138, 94, 138, 133, 7, 2, 10, 88, 84,
    88, 70, 34, 12, 38, 13, 112, 131, 90, 82, 94, 32, 144, 44, 15, 132, 2, 81, 127, 114, 133, 46,
    135, 134, 96, 116, 112, 91, 125, 138, 33, 32, 148, 7, 133, 81, 80, 136, 123, 140, 13, 12, 146,
    12, 90, 83, 134, 32, 145, 144, 14, 98, 88, 107, 133, 122, 98, 150, 151, 146, 4, 5, 13, 91, 134,
    120, 142, 102, 73, 15, 81, 106, 126, 89, 42, 151, 146, 147, 134, 125, 139, 83, 87, 142, 143,
    145, 148, 129, 111, 129, 7, 140, 127, 130, 131, 5, 71, 94, 49, 116, 82, 90, 145, 14, 2, 64, 50,
    68, 7, 133, 73, 150, 71, 108, 138, 4, 94, 125, 138, 142, 143, 142, 129, 10, 11, 10, 128, 162,
    80, 146, 137, 146, 121, 78, 12, 124, 53, 139, 149, 157, 2, 59, 7, 84, 85, 136, 92, 154, 146,
    104, 79, 13, 61, 142, 94, 160, 148, 144, 76, 72, 11, 2, 88, 110, 136, 75, 146, 150, 78, 1, 78,
    121, 70, 86, 148, 30, 145, 51, 2, 7, 92, 137, 162, 158, 150, 104, 9, 125, 159, 49, 138, 161,
    70, 18, 138, 19, 58, 81, 68, 92, 141, 115, 151, 4, 78, 129, 104, 95, 94, 30, 145, 156, 145,
    156, 72, 51, 107, 68, 88, 74, 147, 75, 150, 74, 71, 143, 138, 104, 95, 22, 30, 76, 64, 65, 106,
    166, 141, 162, 159, 151, 74, 29, 66, 90, 138, 83, 116, 153, 30, 130, 98, 107, 81, 15, 166, 21,
    28, 154, 155, 8, 67, 66, 160, 102, 160, 145, 157, 64, 3, 64, 14, 64, 17, 162, 163, 154, 147,
    75, 151, 164, 172, 160, 161, 144, 124, 23, 22, 152, 64, 166, 119, 174, 163, 159, 101, 67, 143,
    66, 161, 160, 172, 30, 144, 3, 2, 69, 153, 51, 126, 44, 166, 158, 70, 71, 70, 48, 13, 173, 160,
    169, 157, 31, 65, 106, 54, 145, 163, 16, 171, 146, 133, 29, 16, 78, 176, 164, 165, 148, 152,
    149, 135, 68, 76, 111, 162, 32, 119, 147, 158, 78, 28, 66, 168, 160, 161, 160, 168, 111, 134,
    68, 69, 179, 99, 166, 154, 171, 139, 70, 25, 71, 161, 177, 161, 31, 26, 130, 144, 69, 76, 111,
    162, 44, 142, 28, 139, 74, 100, 67, 1, 169, 160, 168, 148, 149, 157, 68, 55, 166, 103, 162,
    163, 181, 170, 67, 66, 128, 75, 176, 168, 35, 157, 156, 140, 69, 186, 77, 138, 139, 167, 143,
    171, 25, 147, 4, 74, 181, 79, 136, 185, 141, 30, 7, 167, 64, 33, 32, 139, 143, 67, 97, 67, 74,
    177, 173, 96, 74, 35, 157, 124, 144, 68, 72, 77, 170, 174, 170, 24, 147, 151, 66, 100, 78, 137,
    136, 140, 136, 144, 64, 98, 107, 72, 138, 36, 138, 36, 139, 150, 151, 176, 75, 74, 34, 137,
    144, 183, 144, 64, 106, 65, 76, 41, 174, 166, 138, 146, 67, 108, 129, 34, 136, 152, 165, 7,
    111, 153, 72, 142, 37, 139, 174, 33, 138, 147, 146, 78, 101, 184, 66, 193, 173, 103, 144, 19,
    142, 76, 143, 186, 33, 1, 71, 97, 150, 105, 70, 137, 141, 137, 172, 173, 103, 145, 27, 68, 138,
    37, 195, 21, 180, 79, 146, 78, 108, 141, 185, 140, 192, 2, 144, 145, 111, 110, 183, 190, 175,
    199, 41, 194, 101, 74, 101, 140, 141, 39, 192, 6, 144, 145, 144, 190, 98, 138, 142, 194, 55,
    177, 147, 97, 108, 180, 137,
];
